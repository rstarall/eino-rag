{{define "admin/dashboard.html"}}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.title}}</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/admin.css">
</head>
<body>
    <div id="alert-container" style="position: fixed; top: 1rem; right: 1rem; z-index: 9999;"></div>
<div class="admin-layout">
    <!-- ä¾§è¾¹æ  -->
    <aside class="admin-sidebar">
        <div style="padding: 1.5rem;">
            <h2 style="color: var(--primary-color);">ç®¡ç†åå°</h2>
        </div>
        
        <nav class="admin-nav">
            <a href="/admin/" class="admin-nav-item active">ä»ªè¡¨æ¿</a>
            <a href="/admin/knowledge-bases" class="admin-nav-item">çŸ¥è¯†åº“ç®¡ç†</a>
            <a href="/admin/documents" class="admin-nav-item">æ–‡æ¡£ç®¡ç†</a>
            <a href="/admin/users" class="admin-nav-item">ç”¨æˆ·ç®¡ç†</a>
            <a href="/admin/settings" class="admin-nav-item">ç³»ç»Ÿè®¾ç½®</a>
            <div style="border-top: 1px solid var(--border-color); margin: 1rem 0;"></div>
            <a href="/" class="admin-nav-item">è¿”å›å‰å°</a>
            <a href="#" class="admin-nav-item logout-btn">é€€å‡ºç™»å½•</a>
        </nav>
    </aside>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <main class="admin-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h1 style="margin: 0;">ç³»ç»Ÿæ¦‚è§ˆ</h1>
            <button onclick="loadStats()" class="btn btn-secondary">
                ğŸ”„ åˆ·æ–°æ•°æ®
            </button>
        </div>
        
        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-value">-</div>
                <div class="stat-label">ç”¨æˆ·æ€»æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">-</div>
                <div class="stat-label">çŸ¥è¯†åº“æ€»æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">-</div>
                <div class="stat-label">æ–‡æ¡£æ€»æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">-</div>
                <div class="stat-label">å¯¹è¯æ€»æ•°</div>
            </div>
        </div>
        
        <!-- æœ€è¿‘æ´»åŠ¨ -->
        <div class="card">
            <h2>ä»Šæ—¥æ•°æ®</h2>
            <div class="stats-grid">
                <div style="padding: 1rem;">
                    <div style="font-size: 1.5rem; font-weight: 600; color: var(--success-color);" id="todayUsers">0</div>
                    <div style="color: var(--text-secondary);">æ–°å¢ç”¨æˆ·</div>
                </div>
                <div style="padding: 1rem;">
                    <div style="font-size: 1.5rem; font-weight: 600; color: var(--primary-color);" id="todayDocs">0</div>
                    <div style="color: var(--text-secondary);">æ–°å¢æ–‡æ¡£</div>
                </div>
            </div>
        </div>
        
        <!-- å¿«é€Ÿæ“ä½œ -->
        <div class="card">
            <h2>å¿«é€Ÿæ“ä½œ</h2>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="/admin/knowledge-bases" class="btn btn-primary">åˆ›å»ºçŸ¥è¯†åº“</a>
                <a href="/admin/documents" class="btn btn-secondary">ä¸Šä¼ æ–‡æ¡£</a>
                <a href="/admin/users" class="btn btn-outline">ç®¡ç†ç”¨æˆ·</a>
                <a href="/admin/settings" class="btn btn-outline">ç³»ç»Ÿè®¾ç½®</a>
            </div>
        </div>
    </main>
</div>
    
    <script src="/static/js/api.js"></script>
    <script src="/static/js/app.js"></script>
<script>
// åŠ è½½ç»Ÿè®¡æ•°æ®
async function loadStats() {
    try {
        const result = await api.system.getStats();
        if (result.success) {
            const stats = result.stats;
            
            // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
            const cards = document.querySelectorAll('.stat-card');
            cards[0].querySelector('.stat-value').textContent = stats.user_count || 0;
            cards[1].querySelector('.stat-value').textContent = stats.knowledge_base_count || 0;
            cards[2].querySelector('.stat-value').textContent = stats.document_count || 0;
            cards[3].querySelector('.stat-value').textContent = stats.chat_count || 0;
            
            // æ›´æ–°ä»Šæ—¥æ•°æ®
            document.getElementById('todayUsers').textContent = stats.today_new_users || 0;
            document.getElementById('todayDocs').textContent = stats.today_new_documents || 0;
        }
    } catch (error) {
        console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
    }
}

// åˆå§‹åŒ–
loadStats();

// ç§»é™¤è‡ªåŠ¨åˆ·æ–°ï¼Œæ”¹ä¸ºæ‰‹åŠ¨åˆ·æ–°æŒ‰é’®
// setInterval(loadStats, 30000); // å·²ç¦ç”¨è‡ªåŠ¨åˆ·æ–°
</script>
</body>
</html>
{{end}}